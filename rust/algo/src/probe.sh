#!/bin/bash

pod_ips=(172.23.152.220
    172.23.178.174
    172.23.178.48
    172.23.179.107
    172.23.201.232
    172.23.165.15
    172.23.196.60
    172.23.152.230
    172.23.196.122
    172.23.159.49
    172.23.178.162
    172.23.202.219
    172.23.195.226
    172.23.194.135
    172.23.204.226
    172.23.159.70
    172.23.200.233
    172.23.201.238
    172.23.205.130
    172.23.206.127
    172.23.214.36
    172.23.196.100
    172.23.159.48
    172.23.196.95
    172.23.165.14
    172.23.196.56
    172.23.178.171
    172.23.152.211
    172.23.202.214
    172.23.194.136
    172.23.146.254
    172.23.214.59
    172.23.146.181
    172.23.201.226
    172.23.159.40
    172.23.214.45
    172.23.159.68
    172.23.129.232
    172.23.163.220
    172.23.195.158
    172.23.200.168
    172.23.167.63
    172.23.156.77
    172.23.181.246
    172.23.202.75
    172.23.165.16
    172.23.202.142
    172.23.195.15
    172.23.194.134
    172.23.159.62)

for i in {1..1000}; do
    for ip in ${pod_ips[@]}; do
        echo "probe time $i for $ip: " >> res.txt
        hping3 -c 1000 -S -p 8002 $ip -i u1000 | grep -E "[0-9]{2,}\.[0-9]+ ms" >> res.txt
    done
done
